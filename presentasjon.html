<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Rustne slanger</title>

    <link
            rel="icon"
            type="image/svg+xml"
            sizes="any"
            href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>游냀</text></svg>"
    />
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/reveal.min.css"
            integrity="sha512-0AUO8B5ll9y1ERV/55xq3HeccBGnvAJQsVGitNac/iQCLyDTGLUBMPqlupIWp/rJg0hV3WWHusXchEIdqFAv1Q=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
    />
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/theme/black.min.css"
            integrity="sha512-B1sAcZ4KSpvbIUUvxaoqy56z88d6fozQyEV54K0gVBUMDMcVu9CAXMwJ5wTWo650j3IQH6yDEETiek6lrk/zCw=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
    />
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/plugin/highlight/monokai.min.css"
            integrity="sha512-z8wQkuDRFwCBfoj7KOiu1MECaRVoXx6rZQWL21x0BsVVH7JkqCp1Otf39qve6CrCycOOL5o9vgfII5Smds23rg=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
    />
    <style>
        /* Source: https://github.com/rschmehl/reveal-plugins/blob/main/attribution/attribution.css */
        /* Attribution plugin: text along the right edge of the viewport */
        .attribution{
            position: absolute;
            top: 50%;
            bottom: auto;
            left: 50%;
            right: auto;
            font-size: 0.4em;
            pointer-events: none;
            text-align: center;
            writing-mode: vertical-lr;
            transform: translate( -50%, -50% ) scale( 1 ) rotate( 180deg );
        }

        /* Attribution plugin: activate pointer events for attribution text only */
        .attribution .content{
            pointer-events: auto;
        }
    </style>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section>
            <section
                    data-background-image="public/DALL췅E%202024-10-14%2012.35.50%20-%20An%20illustration%20of%20a%20rusty%20snake%20that%20looks%20like%20a%20hacker.%20The%20snake's%20body%20is%20made%20of%20corroded%20metal%20parts%20with%20rust%20and%20patches%20of%20exposed%20wires.%20It.webp">
                <!-- Beskrivelse: Den har en cyberpunk-stil med rustne metalliske kroppsdeler, gl칮dende 칮yne og en digital atmosf칝re rundt-->
                <h1>Rustne slanger</h1>
                <p>En oppf칮lger til "Slangeolje"</p>

                <span class="attribution">
                    Illustrasjon av ChatGPT, DALL - E
                </span>
            </section>
        </section>
        <section>
            <section>
                <h1 style="text-transform: none;">PyO<sub>3</sub><span class="fragment">?</span></h1>
                <ul>
                    <li class="fragment">
                        <a href="https://pyo3.rs/v0.22.4/">Et bibliotek</a> for Python-bindinger i Rust
                    </li>
                    <li class="fragment">
                        <a href="https://github.com/PyO3">Et prosjekt</a> for 친 st칮tte opp om 친 bruke Rust i Python
                        <span class="fragment">
                            (og Python i Rust)
                        </span>
                    <ul>
                        <li class="fragment">
                            <a href="https://github.com/PyO3/maturin"><pre>maturin</pre></a>
                        </li>
                        <li class="fragment">
                            <a href="https://github.com/PyO3/rust-numpy"><pre>rust-numpy</pre></a>
                        </li>
                    </ul>
                    </li>
                </ul>
            </section>
            <section>
                <h1><code>maturin</code></h1>

                <pre class="fragment"><code class="language-bash" data-trim data-noescape>
                    pip install maturin
                    maturin init
                    maturin develop --release
                </code></pre>
            </section>
        </section>
        <section>
            <section data-auto-animate data-transition="slide-in">
                <h1>Rust</h1>
                <pre><code
                        class="language-rust"
                        data-trim
                        data-noescape
                        data-line-numbers="|1-2|5-14|13"
                >
use ::pyo3::prelude::*;
use num::complex::{Complex, ComplexFloat};

#[pyfunction]
fn mandelbrot(x: f64, y: f64, cutoff: u32) -> PyResult&lt;u32&gt; {
    let mut z: Complex&lt;f64&gt; = Complex::new(0.0, 0.0);
    let c = Complex::new(x, y);
    let mut iterations = 0;
    while iterations < cutoff && z.abs() <= 2.0 {
        z = z.powu(2) + c;
        iterations += 1;
    }
    Ok(iterations - 1)
}
                </code></pre>
                <aside class="notes">
                    Her vises Rust koden for 친 estimere om et tall er med i Mandelbrot settet eller ikke.
                    <br>
                    Det er en direkte omskrivning av Python koden.

                    <br><br>
                    <code>use</code> n칮kkelordet brukes for 친 importere "ting" fra andre moduler.
                    <br>
                    Det kan v칝re funksjoner og moduler, men ogs친 makroer, <a href="https://doc.rust-lang.org/rust-by-example/trait.html">egenskaper (eng. "traits")</a>
                    <br>
                    "trait" er en samling funksjoner som virker p친 en ukjent datatype.

                    <br><br>
                    Selve funksjonen er ganske rett frem
                    Rust har ikke en innebygget type for komplekse tall, s친 vi bruker <a href="https://docs.rs/num/latest/num/">num</a>-pakken

                    <br><br>
                    <code>Ok</code> indikerer at funksjonen avsluttet korrect.
                    <br>
                    <strong>MERK</strong>: Den linjen har <em>ikke</em> et seikolon til slutt.
                    <br>
                    I rust, er det en konvensjon at siste linje i en funksjon uten semikolon retuneres.
                </aside>
            </section>
            <section data-transition="none">
                <h1>Rust</h1>
            <pre><code
                    class="language-rust"
                    data-trim
                    data-noescape
                    data-line-numbers="13"
            >
use ::pyo3::prelude::*;
use num::complex::{Complex, ComplexFloat};

#[pyfunction]
fn mandelbrot(x: f64, y: f64, cutoff: u32) -> PyResult&lt;u32&gt;; {
    let mut z: Complex&lt;f64&gt; = Complex::new(0.0, 0.0);
    let c = Complex::new(x, y);
    let mut iterations = 0;
    while iterations < cutoff && z.abs() <= 2.0 {
        z = z.powu(2) + c;
        iterations += 1;
    }
    return Ok(iterations - 1);
}
                </code></pre>
                <aside class="notes" data-transition="fade-in">
                    Dette er tilsvarende
                </aside>
            </section>
            <section data-auto-animate data-transition="none">
                <h1>Rust</h1>
                <pre id="pyfunction-makro"><code
                        class="language-rust"
                        data-trim
                        data-noescape
                        data-line-numbers="4"
                >
use ::pyo3::prelude::*;
use num::complex::{Complex, ComplexFloat};

#[pyfunction]
fn mandelbrot(x: f64, y: f64, cutoff: u32) -> PyResult&lt;u32&gt;; {
    let mut z: Complex&lt;f64&gt; = Complex::new(0.0, 0.0);
    let c = Complex::new(x, y);
    let mut iterations = 0;
    while iterations < cutoff && z.abs() <= 2.0 {
        z = z.powu(2) + c;
        iterations += 1;
    }
    Ok(iterations - 1)
}
                </code></pre>
                <aside class="notes">
                    men, tilbake til den originale funskonen.
                    <pre>#[pyfunction]</pre> er en "attribute macro".
                    Den deler noen likheter med en dekorat칮r i Python, men i stedet for 친 v칝re en h칮yere ordens funksjon,
                    oppererer den p친 selve syntaksen (en "TokenStream" / str칮m av "TokenTree").
                    Den kan manipuleres og returneres s친 (til kompilatoren).
                    I dette tilfellet, legger den til diverse kode for 친 bruke Python sitt C-API fra Rust.

                    Hvis det er interesse / tid, kan vi se p친 resultatet etter at makroen er ekspandert.
                </aside>
            </section>
            <section data-auto-animate data-transition="fade-out">
                <H1>Rust</H1>
                <pre data-id="python-modul"><code
                        class="language-rust"
                        data-trim
                        data-noescape
                        data-line-numbers="|1|2-4|2|3|4,8|5-7|6"
                >
#[pymodule]
fn pyo3<'py>(
        module: &Bound<'py, PyModule>
) -> PyResult<()> {
    module.add_function(
        wrap_pyfunction!(mandelbrot, module)?
    )?;
    Ok(())
}
                </code></pre>
                <aside class="notes">
                    <a href="https://pyo3.rs/v0.22.4/module"><pre>pymodule</pre></a> er en makro som eksporterer initialiseringen / oppsettet av modulen.

                    <br><br>
                    <code>pyo3</code> er navnet til den eksporterte funksjonen. Man kan sette det til noe annevt ved 친 bruke en makro.
                    <br>
                    <code>&lt;'py&gt;</code> indikerer at vi forventer 친 l친ne (eng. "borrow") et (generisk) livstid-parameter (eng. "lifetime").
                    <br>
                    <code>&Bound&lt;'py, PyModule&gt;</code> indikerer at <code>module</code> er l친nt og er en smartpeker som h친ndterer Python sin GIL.

                    <br><br>
                    Strengt tatt, ville denne funksjonen fungert fint uten, siden vi ikke bruker den.

                    <br><br>
                    <code>PyResult<()></code> sier oss at denne kunksjonen ikke returnerer noe.
                    <br>
                    <code>PyResult</code> er en liten pakkning ("wrapper") runtd Rust sitt ennebygget <code>Result</code>

                    <br><br>
                    <code>wrap_function!</code> er enda en makro.
                    <br>
                    Denne gangen, en funksjons-aktig makro. (Det ser ut som at du kaller en vanlig funksjon)

                    <br><br>
                    Leg merke til <strong>?</strong>-ene. De brukes for sende feil ("panikk") videre.
                </aside>
            </section>
<section data-auto-animate>
    <h1>Rust</h1>
    <pre><code
            class="language-rust"
            data-trim
            data-noescape
            data-line-numbers
    >
#[pymodule]
mod pyo3 {
    use super::*;

    #[pymodule_export]
    use super::mandelbrot;

    #[pymodule_init]
    fn init(m: &Bound<'_, PyModule>) -> PyResult<()>{
        Ok(())
    }
}
    </code></pre>
    <aside class="notes">
        Det g친r ogs친 ann 친 v칝re mer eksplisitt n친r en lager moduler
    </aside>
</section>

            <section>
                <h1>Utvidet makro</h1>
                <pre><code class="language-rust" data-trim data-noescape>
#![feature(prelude_import)]
#[prelude_import]
use std::prelude::rust_2021::*;
#[macro_use]
extern crate std;
use ::pyo3::prelude::*;
use num::complex::{Complex, ComplexFloat};

#[doc = &quot; Compute the margins of the mandelbrot set&quot;]
fn mandelbrot(x: f64, y: f64, cutoff: u32) -&gt; PyResult&lt;u32&gt; {
    let mut z: Complex&lt;f64&gt; = Complex::new(0.0, 0.0);
    let c = Complex::new(x, y);
    let mut iterations = 0;
    while iterations &lt; cutoff &amp;&amp; z.abs() &lt;= 2.0 {
        z = z.powu(2) + c;
        iterations += 1;
    }
    Ok(iterations - 1)
}
#[doc(hidden)]
mod mandelbrot {
    pub(crate) struct MakeDef;
    pub const _PYO3_DEF: ::pyo3::impl_::pymethods::PyMethodDef =
        MakeDef::_PYO3_DEF;
}
#[allow(unknown_lints, non_local_definitions)]
impl mandelbrot::MakeDef {
    const _PYO3_DEF: ::pyo3::impl_::pymethods::PyMethodDef =
        ::pyo3::impl_::pymethods::PyMethodDef::fastcall_cfunction_with_keywords(
            c&quot;mandelbrot&quot;,
            {
                unsafe extern &quot;C&quot; fn trampoline(
                    _slf:
                    *mut ::pyo3::ffi::PyObject,
                    _args: *const *mut ::pyo3::ffi::PyObject,
                    _nargs: ::pyo3::ffi::Py_ssize_t,
                    _kwnames: *mut ::pyo3::ffi::PyObject)
                    -&gt; *mut ::pyo3::ffi::PyObject {
                    ::pyo3::impl_::trampoline::fastcall_with_keywords(
                        _slf,
                        _args, _nargs, _kwnames, __pyfunction_mandelbrot)
                }
                trampoline
            },
            c&quot;mandelbrot(x, y, cutoff)\n--\n\nCompute the margins of the mandelbrot set&quot;);
}
#[allow(non_snake_case)]
unsafe fn __pyfunction_mandelbrot&lt;&#39;py&gt;(
    py: ::pyo3::Python&lt;&#39;py&gt;,
    _slf: *mut ::pyo3::ffi::PyObject,
    _args: *const *mut ::pyo3::ffi::PyObject, _nargs: ::pyo3::ffi::Py_ssize_t,
    _kwnames: *mut ::pyo3::ffi::PyObject)
    -&gt; ::pyo3::PyResult&lt;*mut ::pyo3::ffi::PyObject&gt; {
    let _slf_ref = &amp;_slf;
    let function = mandelbrot;
    const DESCRIPTION: ::pyo3::impl_::extract_argument::FunctionDescription =
        ::pyo3::impl_::extract_argument::FunctionDescription {
            cls_name: ::std::option::Option::None,
            func_name: &quot;mandelbrot&quot;,
            positional_parameter_names: &amp;[&quot;x&quot;, &quot;y&quot;, &quot;cutoff&quot;],
            positional_only_parameters: 0usize,
            required_positional_parameters: 3usize,
            keyword_only_parameters: &amp;[],
        };
    let mut output = [::std::option::Option::None; 3usize];
    let (_args, _kwargs) =
        DESCRIPTION.extract_arguments_fastcall::&lt;::pyo3::impl_::extract_argument::NoVarargs,
            ::pyo3::impl_::extract_argument::NoVarkeywords&gt;(
            py, _args,
            _nargs, _kwnames, &amp;mut output)?;
    #[allow(clippy::let_unit_value)]
    let mut holder_0 =
        ::pyo3::impl_::extract_argument::FunctionArgumentHolder::INIT;
    let mut holder_1 =
        ::pyo3::impl_::extract_argument::FunctionArgumentHolder::INIT;
    let mut holder_2 =
        ::pyo3::impl_::extract_argument::FunctionArgumentHolder::INIT;
    let gil_refs_checker_0 = ::pyo3::impl_::deprecations::GilRefs::new();
    let gil_refs_checker_1 = ::pyo3::impl_::deprecations::GilRefs::new();
    let gil_refs_checker_2 = ::pyo3::impl_::deprecations::GilRefs::new();
    let result =
        {
            let ret =
                function(
                    ::pyo3::impl_::deprecations::inspect_type(
                        ::pyo3::impl_::extract_argument::extract_argument(
                            ::pyo3::impl_::extract_argument::unwrap_required_argument(output[0usize].as_deref()),
                            &amp;mut holder_0, &quot;x&quot;)?, &amp;gil_refs_checker_0),
                    ::pyo3::impl_::deprecations::inspect_type(
                        ::pyo3::impl_::extract_argument::extract_argument(
                            ::pyo3::impl_::extract_argument::unwrap_required_argument(output[1usize].as_deref()),
                            &amp;mut holder_1, &quot;y&quot;)?, &amp;gil_refs_checker_1),
                    ::pyo3::impl_::deprecations::inspect_type(
                        ::pyo3::impl_::extract_argument::extract_argument(
                            ::pyo3::impl_::extract_argument::unwrap_required_argument(output[2usize].as_deref()),
                            &amp;mut holder_2, &quot;cutoff&quot;)?, &amp;gil_refs_checker_2));
            ::pyo3::impl_::wrap::map_result_into_ptr(
                py,
                ::pyo3::impl_::wrap::OkWrap::wrap(ret).map_err(::core::convert::Into::&lt;::pyo3::PyErr&gt;::into))
        };
    gil_refs_checker_0.function_arg();
    gil_refs_checker_1.function_arg();
    gil_refs_checker_2.function_arg();
    result
}
                </code></pre>
            </section>
        </section>
    </div>
</div>
<script
        src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/reveal.js"
        integrity="sha512-35L3EFHQcGaTZ6QN9wAg9iK1hTPVCn8RGsscuXjm5JdmDRyOw+/IWJ4wavGkozQ8VDoddD7nV1psHgu/BYNpxQ=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
></script>
<script
        src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/plugin/highlight/highlight.js"
        integrity="sha512-jV0+zNIfrHZjauCtHa+3iWtk5V+/aP4vcYf788GmhoUt5lfYaVtHh6Kuci8QJHEWSFDjXrqrQhieCdiageDa0g=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
></script>
<script
        src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/5.1.0/plugin/notes/notes.js"
        integrity="sha512-Oavww7oyn4kdnb1KGntdvKq62AzdNgN8/Oe6/ECAPLEsL2Z566tXslDwUiSTY0Zc5KQVz6HiCH0lnIvL+Xp7IQ=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
></script>
<script>
    /*****************************************************************
     ** Author: Roland Schmehl, r.schmehl@tudelft.nl
     **
     ** A plugin for displaying attribution texts sideways along the right
     ** edge of the viewport. When resizing the viewport or toggling full
     ** screen mode, the attribution text sticks persistently to the right
     ** edge of the viewport.
     **
     ** The dynamic scaling of the attribution text via CSS transform
     ** is adopted from the fullscreen plugin.
     **
     ** Version: 1.0
     **
     ** License: MIT license (see file LICENSE)
     **
     ******************************************************************/

    window.RevealAttribution = window.RevealAttribution || {
        id: 'RevealAttribution',
        init: function(deck) {
            initAttribution(deck);
        }
    };

    const initAttribution = function(Reveal){

        var ready = false;
        var resize = false;
        var scale = 1;

        window.addEventListener( 'ready', function( event ) {

            var content;

            // Remove configured margin of the presentation
            var attribution = document.getElementsByClassName("attribution");
            var width = window.innerWidth;
            var configuredWidth = Reveal.getConfig().width;
            var configuredHeight = Reveal.getConfig().height;

            scale = 1/(1-Reveal.getConfig().margin);

            for (var i = 0; i < attribution.length; i++) {
                content = attribution[i].innerHTML;
                attribution[i].style.width = configuredWidth + "px";
                attribution[i].style.height = configuredHeight + "px";
                attribution[i].innerHTML = "<span class='content'>" + content + "</span>";
                attribution[i].style.transform = 'translate( -50%, -50% ) scale( ' + scale*100 + '% ) rotate(-180deg)';
            }

            // Scale with cover class to mimic backgroundSize cover
            resizeCover();

        });

        window.addEventListener( 'resize', resizeCover );

        function resizeCover() {

            // Scale to mimic backgroundSize cover
            var attribution = document.getElementsByClassName("attribution");
            var xScale = window.innerWidth / Reveal.getConfig().width;
            var yScale = window.innerHeight / Reveal.getConfig().height;
            var s = 1;

            if (xScale > yScale) {
                // The div fits perfectly in x axis, stretched in y
                s = xScale/yScale;
            }
            for (var i = 0; i < attribution.length; i++) {
                attribution[i].style.transform = 'translate( -50%, -50% ) scale( ' + s*scale*100 + '% ) rotate(-180deg)';
            }
        }

    };
</script>
<script>
    Reveal.initialize({
        plugins: [RevealNotes, RevealHighlight, RevealAttribution],
        hash: true,
        progress: true,
        totalTime: 50 /* minutter */ * 60 /* sekunder */
    });
</script>
</body>
</html>